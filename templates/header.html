{% load static %}
<nav class="main-header navbar navbar-expand navbar-dark"
  style="background-color:#309be2; border-bottom: 2px solid #dee2e6;">
  <ul class="navbar-nav">
    <li class="nav-item">
      <a class="nav-link" data-widget="pushmenu" role="button"><i class="fas fa-bars"></i></a>
    </li>
  </ul>

  <ul class="navbar-nav ml-auto">
    <li class="nav-item">
      <a class="nav-link" data-widget="fullscreen" role="button">
        <i class="fas fa-expand-arrows-alt"></i>
      </a>
    </li>
    <li class="nav-item">
      <div class="dropdown">
        <button class="nav-link btn btnNot" id="btnNot" type="button">
          <i class="fas fa-envelope"></i>
        </button>
        <div class="Menu_NOtification_Wrap" id="containerNot">
          <div class="notification_Header">
            <h4>Notificaciones</h4>
          </div>
          <div class="Notification_body">

            <div class="single_notify d-flex align-items-center">
              <div class="notify_thumb box-move">
                <img src="{{request.user.get_image}}" alt="">
              </div>
              <div class="notify_content">
                <a href="/">
                  <h5>{{ request.user.get_full_name }} </h5>
                </a>
                <p>Lorem ipsum dolor sit amet</p>
              </div>
            </div>
            <div class="single_notify d-flex align-items-center">
              <div class="notify_thumb box-move">
                <img src="{{request.user.get_image}}" alt="">
              </div>
              <div class="notify_content">
                <a href="/">
                  <h5>{{ request.user.get_full_name }} </h5>
                </a>
                <p>Lorem ipsum dolor sit amet</p>
              </div>
            </div>
            <div class="single_notify d-flex align-items-center">
              <div class="notify_thumb box-move">
                <img src="{{request.user.get_image}}" alt="">
              </div>
              <div class="notify_content">
                <a href="/">
                  <h5>{{ request.user.get_full_name }} </h5>
                </a>
                <p>Lorem ipsum dolor sit amet</p>
              </div>
            </div>
            <div class="single_notify d-flex align-items-center">
              <div class="notify_thumb box-move">
                <img src="{{request.user.get_image}}" alt="">
              </div>
              <div class="notify_content">
                <a href="/">
                  <h5>{{ request.user.get_full_name }} </h5>
                </a>
                <p>Lorem ipsum dolor sit amet</p>
              </div>
            </div>
          </div>
          <div class="nofity_footer">
            <div class="submit_button text-center pt_20">
              <a href="/" class="btn_1 f-12">Ver Más</a>
            </div>
          </div>
        </div>

      </div>

    </li>
    <li class="nav-item dropdown">

      <!-- cerrar sesion Dropdown Menu -->
    <li class="nav-item dropdown ">
    <li class="dropdown user user-menu">
      <a href="#" class="nav-link btnPanel  dropdown-toggle" data-toggle="dropdown">
        <img src="{{request.user.get_image}}" class="user-image" style="width: 29px; height: 29px;" alt="User Image">
        <span class="hidden-xs">{{request.user.get_full_name}}</span>
      </a>
      <ul class="dropdown-menu dropdown-animation h-blue">
        <!-- User image -->
        <li class="user-header" style="background-color: #2196f3; color: #fff;">
          <img src="{{request.user.get_image}}" class="img-circle" alt="User Image">
          <p>
            {{request.user.get_full_name}}
            <small>{{request.user.last_login}}</small>
          </p>
        </li>
        <!-- Menu Body -->
        <li class="user-body text-sm" style="border-bottom: 1px solid #dee2e6;">
          <div class="row">
            <div class="col-sm-4 text-center">
              <a href="{% url 'user:user_profile' %}">Editar Perfil</a>
            </div>
            <div class="col-sm-4 text-center">
              <a href="{% url 'user:user_change_password' %}">Cambiar Contraseña</a>
            </div>
            <div class="col-sm-4 text-center">
              <a>Bandeja de Entrada</a>
            </div>
          </div>
          <!-- /.row -->
        </li>
        <!-- Menu Footer-->
        <li class="user-footer text-sm">
          <div class="float-sm-left">
            <a class="btn btn-default btn-flat text-secondary" onclick="abrir_modal_usuario()">Perfil</a>
          </div>
          <div class="float-sm-right">
            <a href="{% url 'usuarios_app:logout' %}" class="btn btn-default btn-flat text-secondary">Salir</a>
          </div>
        </li>
      </ul>
    </li>
    </li>
  </ul>
</nav>

<!--MODAL INFORMACION DEL USUARIO-->
<div class="modal fade" id="detalle_usuario" data-backdrop="static" tabindex="-1" role="dialog"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header elevation-1 h-blue py-2">
        <h5 class="modal-title title-custom" id="perfil_user"><b><i class="far fa-id-card"></i></i> Perfil de
            Usuario</b></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="row">
        <div class="col">
          <div class="user-panel mt-4 pb-2 mb-3 d-flex">
            <div class="image">
              <img src="{{request.user.get_image}}" style="width: 100px; height: 100px; margin-left: 170px;"
                class="img-circle elevation-1" alt="User Image">
            </div>
          </div>
        </div>
        <div class="col">
          <ol class="float-sm-right mt-0 my-0">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="fas fa-ellipsis-v" style="color: rgb(119, 118, 118);"></i>
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <a href="{% url 'user:user_profile' %}" class="dropdown-item">
                <i class="fas fa-edit mr-2"></i>Editar Perfil
              </a>
              <a href="{% url 'user:user_change_password' %}" class="dropdown-item">
                <i class="fas fa-lock mr-2"></i>Cambiar Contraseña
              </a>
            </div>
          </ol>
        </div>
      </div>
      <div class="modal-body ml-2">
        <hr style="margin-top: -10px;">
        <div class="row">
          <div class="col">
            <i class="fas fa-user"></i>
            <label class="ml-1">Nombre de Usuario</label><br>
            <p> <span id="group" class="ml-4">{{request.user.username}}</span></p>
            <hr style="margin-top: -10px;">
          </div>
        </div>
        <div class="row g-2">
          <div class="col">
            <i class="fas fa-signature"></i>
            <label>Nombre</label><br>
            <p> <span id="group" class="ml-4">{{request.user.first_name}}</span></p>
            <hr style="margin-top: -10px;">
          </div>
          <div class="col">
            <i class="fas fa-signature"></i>
            <label>Apellido</label><br>
            <p> <span id="group" class="ml-4">{{request.user.last_name}}</span></p>
            <hr style="margin-top: -10px;">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col">
            <i class="fas fa-sort-numeric-down"></i>
            <label class="ml-1">Cédula</label><br>
            <p> <span id="group" class="ml-4">{{request.user.dni}}</span></p>
            <hr style="margin-top: -10px;">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col">
            <i class="fas fa-envelope"></i>
            <label class="ml-1">Email</label><br>
            <p> <span id="group" class="ml-4">{{request.user.email}}</span></p>
            <hr style="margin-top: -10px;">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col">
            <i class="fas fa-layer-group"></i>
            <label class="ml-1">Rol(es) de Sistema</label>
            <span id="group"> {% for x in request.user.groups.all %}<li>{{x.name}}</li>{% endfor %}</span>

          </div>
        </div>

      </div>
      <div class="modal-footer py-1">
        <button type="button" class="btn btn-secondary" onclick="cerrar_modal_usuario();"
          style="margin-right: 200px;"><i class="fas fa-times-circle"></i> Cerrar</button>
      </div>

    </div>
  </div>
</div>
<script>
  let btn = document.getElementById('btnNot')
  let cont = document.getElementById('containerNot')
  let notiActive = false;

  btn.addEventListener('click', function () {
    if (notiActive == false) {
      cont.classList.add("active");
      notiActive = true;
    } else if (notiActive == true) {
      cont.classList.remove("active");
      notiActive = false;
    }
    console.log('Click')
  })
  document.addEventListener('click', function (event) {
    if (notiActive && !cont.contains(event.target) && !btn.contains(event.target)) {
      cont.classList.remove('active');
      notiActive = false;      
    }
  });
</script>
<script>
  function abrir_modal_usuario() {
    $("#detalle_usuario").modal("show");
    $('#perfil_user').find('i').removeClass().addClass('far fa-id-card');
  }
  function cerrar_modal_usuario() {
    $("#detalle_usuario").modal("hide");
  }
</script>